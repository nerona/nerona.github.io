<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>${title }</title>
	<meta name="format-detection" content="telephone=no"/>
	<meta name="format-detection" content="email=no"/>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">

	<link rel="stylesheet" href="./../../css/sm.min.css">
	<link rel="stylesheet" href="./../../css/pt/index.css">

	<script type='text/javascript' src='./../../js/lib/zepto.min.js' charset='utf-8'></script>
	<script type='text/javascript' src="./../../js/lib/touch.min.js"></script>
	<script type='text/javascript' src='./../../js/lib/common.js' charset='utf-8'></script>
	<script type='text/javascript' src='./../../js/lib/sm.min.js' charset='utf-8'></script>

	<script>
		//tab link
		$(function () {
			$('.tab .flex-item-three:nth-child(1)').on('tap', function () {
				document.location.href = './../shop/index.html';
			});
			$('.tab .flex-item-three:nth-child(2)').on('tap', function () {
				document.location.href = './../pt/index.html';
			});
			$('.tab .flex-item-three:nth-child(3)').on('tap', function () {
				document.location.href = './../my/index.html';
			});
		});
	</script>
</head>
<body>

<div class="page-group">
    <div class="page page-current">
    	<header class="bar bar-nav">
  			<a class="icon icon-back pull-left back"></a>
  			<span class="pull-right edit">编辑</span>
  			<h1 class="title">银行卡</h1>
		</header>
    	<div class="content page-bank-card">
       		<ul class="card-list">
       			<!-- 默认 -->
       			<li class="flex-line card-default">
       				<div class="card-icon">
       					<img src="${ctxPath }/m/new/images/pt/ka.png">
       				</div>
       				<div class="card-info">
       					<p class="card-name">中国建设银行</p>
       					<p class="card-id">**** **** **** <span>1234</span></p>
       				</div>
       				<%-- <img src="${ctxPath }/m/new/images/pt/del.png" class="del-card"> --%>
       			</li>
       			<li class="flex-line card-item">
       				<div class="card-icon">
       					<img src="${ctxPath }/m/new/images/pt/ka.png">
       				</div>
       				<div class="card-info">
       					<p class="card-name">中国建设银行</p>
       					<p class="card-id">**** **** **** <span>1234</span></p>
       				</div>
       				<img src="${ctxPath }/m/new/images/pt/del.png" class="del-card">
       			</li>
       			<li class="flex-line card-item">
       				<div class="card-icon">
       					<img src="${ctxPath }/m/new/images/pt/ka.png">
       				</div>
       				<div class="card-info">
       					<p class="card-name">中国工商银行</p>
       					<p class="card-id">**** **** **** <span>4321</span></p>
       				</div>
       				<img src="${ctxPath }/m/new/images/pt/del.png" class="del-card">
       			</li>
       		</ul>
       		<!-- 添加ka -->
       		<div class="add-card">
       			<span>添加银行卡</span>
       		</div>
    	</div>
    </div>
    <!-- box -->
    <div class="box-mask">
    	<div class="confirm-box">
    		<div class="confirm-title">确定要删除银行卡吗？</div>
    		<div class="confirm-content">
    			<input type="password" placeholder="请输入支付密码">
    		</div>
    		<div class="confirm-btns">
    			<span class="confirm-sure">确&nbsp;定</span>
    			<span class="confirm-cancel">取&nbsp;消</span>
    		</div>
    	</div>
    </div>
    <!---->
    <%-- <div class="msg-ring">
    	<img src="${ctxPath }/m/new/images/xiaoxi.png">
    	<span>1</span>
    </div> --%>
    <!---->
    <nav class="tab flex-line">
        <div class="flex-item-three">
            <img src="${ctxPath }/m/new/images/shouye_gray.png" alt="">
            <p>首页</p>
        </div>
        <div class="flex-item-three active">
            <img src="${ctxPath }/m/new/images/gongxiangfugui.png" alt="">
            <p>共享富贵</p>
        </div>
        <div class="flex-item-three">
            <img src="${ctxPath }/m/new/images/wo_gray.png" alt="">
            <p>我的</p>
        </div>
    </nav>
</div>

<script>
	$(function(){
		common.Util.setWxTitle("银行卡");
		//show del btn
		var flag = true;
		$('.edit').on('tap', function(){
			if(flag) {
				$(this).html('取消');
				$('.del-card').show();
				flag = false;
			} else {
				$(this).html('编辑');
				$('.del-card').hide();
				flag = true;
			}	
		});
		//卡切换
		$('.card-item').on('tap', function(){
			$('.card-default').css('opacity', '.8');
			setTimeout(function(){
				$('.card-default').css('opacity', '1');
			}, 100);
			
			var temp_name, temp_num;
			temp_name = $('.card-default .card-name').html();
			temp_num = $('.card-default .card-id > span').html();
			
			$('.card-default .card-name').html($(this).find('.card-name').html());
			$('.card-default .card-id > span').html($(this).find('.card-id > span').html());
		});
		//卡删除
		$('.del-card').on('tap', function(e){
			e.stopPropagation();
			if($('.card-default .card-name').html() == $(this).parent().find('.card-name').html() && $('.card-default .card-id > span').html() == $(this).parent().find('.card-id > span').html()) {
				//$.toast("已选择的默认卡不能删除!");
				var self = this;
				$('.box-mask').show().on('tap', '.confirm-sure', function(){
					//校验支付密码  todo
					//if true
					$('.card-default .card-name').html("未设置默认银行卡!");
					$('.card-default .card-id > span').html(" ");
					$(self).parent().remove();
					$('.box-mask').hide();
				}).on('tap', '.confirm-cancel', function(){
					$('.box-mask').hide();
				});				
			} else {
				var self = this;
				//remove card
				$('.box-mask').show().on('tap', '.confirm-sure', function(){
					//校验支付密码  todo
					//if true
					$(self).parent().remove();
					$('.box-mask').hide();
				}).on('tap', '.confirm-cancel', function(){
					$('.box-mask').hide();
				});
				
			}
		});
	});
</script>
</body>
</html>