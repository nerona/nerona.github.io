<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.5,maximum-scale=0.65 , user-scalable=0">
    <base href="../../../"/>
    <link rel="stylesheet" href="css/common/jquery.mobile-1.4.5.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/common/common.css" />
    <link rel="stylesheet" href="css/style2.css"/>
    <link rel="stylesheet" href="css/business/user/edit-info.css"/>
</head>
<body>
<section data-role="header" data-theme="b" class="my-header" id="my-header">
    <a href="javascript:history.back();" data-rel="back" data-role="none" class="my-header-back-btn"></a>
    <h2 id="title">编辑</h2>
    <a href="#" class="my-header-right-btn" data-role="none" onclick="saveUserInfo()"><b>保存</b></a>
</section>
<section data-role="content" role="main" class ="edit-info-main">
    <div class="my-ui-input">
        <input name="text" id="edit-info-input" type="text"  data-role="none" value="">
        <a href="#" data-role="none" class="clear-a-text"></a>
    </div>
</section>
</body>
<script src="js/common/jquery.min.js"></script>
<script>
    $(document).bind('mobileinit', function () {
        $.mobile.changePage.defaults.changeHash = false;
        $.mobile.hashListeningEnabled = false;
        $.mobile.pushStateEnabled = false;
    });
    $(function () {
        var text = Util.common.getParameter("text");
       $("#edit-info-input").val(text);
    });
    function saveUserInfo(){
        var url = Util.common.baseUrl +"/mobile/user/updateUserMsg.do";
        var userName = Util.common.getParameter("user");
        var userInfo =  JSON.parse(localStorage.getItem(userName));
        var name = Util.common.getParameter("name");
        var text = $("input[name=text]").val();
        var data = '{"shopId":"'+userInfo.msg.id+'","'+name+'":"'+text+'"}';
        var param = {"param":data};
        Util.common.executeAjaxCallback(url ,param,function(data){
            if(data.code==0){
                userInfo.msg[name]=text;
                localStorage.setItem(userName,JSON.stringify(userInfo));
                history.back();
            }
        })
    }
</script>
<script src="js/common/jquery.mobile-1.4.5.min.js"></script>
<script src="js/business/common/common.js"></script>
<script src="js/common/common.js"></script>
</html>