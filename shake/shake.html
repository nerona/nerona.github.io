<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>HTML5 手机摇一摇</title>
</head>
<body>
<input type="text" name="txt" id="txt" value="0" />次
<div>diff time: <span id="diff"></span></div>
<div>HTML 5 手机摇一摇，在手机上运行的6。</div>


<script type="text/javascript">
    var i = 0;
    var color = new Array('#fff', '#ff0', '#f00', '#000', '#00f', '#0ff');
    var last_time = 0;
    if(window.DeviceMotionEvent) {
        var speed = 20;
        var x = y = z = lastX = lastY = lastZ = 0;
        window.addEventListener('devicemotion', function(){
            var acceleration =event.accelerationIncludingGravity;
            x = acceleration.x;
            y = acceleration.y;
            var cur_time = new Date().getTime();
            var diff_time = cur_time - last_time;
            document.getElementById("diff").innerHTML = diff_time;
            if(Math.abs(x-lastX) > speed || Math.abs(y-lastY) > speed) {
                i += parseInt(1);//自加变量
                var txt = document.getElementById("txt");//获取text属性
                txt.value = i;//将次数i赋值给text
                document.body.style.backgroundColor = color[Math.round(Math.random()*10)%6];
            }
            lastX = x;
            lastY = y;
            last_time = cur_time;
        }, false);
    } else {
        alert('您的设备不支持摇一摇哦');
    }
</script>
</body>
</html>